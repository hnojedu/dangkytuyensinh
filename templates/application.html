{% load static %}

<div>
    {% if form.errors|length %}
    <div style="color: #a94442;background-color: #f2dede; border-color: #d6e9c6;margin:.4em;border: 1px solid transparent; border-radius: 4px;">
        {{form.non_field_errors }}
    </div>
    {% endif %}
    {% for field in form %}
        {% if field.errors|length %}
        <div style="color: #a94442;background-color: #f2dede; border-color: #d6e9c6;margin:.4em;border: 1px solid transparent; border-radius: 4px;">
            {{field.errors}}
        </div>
        {% endif %}
    {% endfor %}
</div>
<div style="margin:0 auto;" id="application-form">

    <style>
        #wrapper{
            margin-left: 15mm;
            margin-right: 15mm;
            margin-top: 10mm;
        }
        #btn {
            background-color: black;
            color: white;
            padding: 0.5rem;
            font-family: sans-serif;
            cursor: pointer;
        }
    </style>

   
    <form action="" method="POST" id="wrapper" enctype="multipart/form-data"> 
        {% csrf_token %}
        {{ form.id }}      
        <link rel="stylesheet" type="text/css" href="{% static 'application.css' %}">


        <div id="header">
            <div id = "picture" style="word-wrap: break-word; overflow: hidden; {% if not done %}border:1px solid black{% endif %}; ">
                {% if not done %}
                <label for="id_anh_3x4" id="btn">Chọn ảnh</label>
                    {% if application.anh_3x4  %}
                    <span id="file-chosen">Đã chọn ảnh <img src="{{application.anh_3x4.url}}" style="width: 15mm;height: 20mm;"></span>
                    {% else %}
                    <span id="file-chosen">Chưa chọn ảnh</span>
                    {% endif %}
                    <img id="output" hidden="false" style="border:none;width: 15mm;height: 20mm;"/>

                    <div style="visibility:hidden" >{{form.anh_3x4}}</div>
                {% else %}
                    <img src="{{application.anh_3x4.url}}" style="width: 30mm;height: 40mm;">
                {% endif %}
            </div>
            <div style="overflow: hidden;">
                <center>
                    <p style="margin:.2em;font-size:6mm;font-weight:bold;">PHIẾU ĐĂNG KÝ DỰ TUYỂN VÀO LỚP 6</p>
                    <h5 style="margin:.2em;font-size:4mm;font-weight:bold;">TRƯỜNG TRUNG HỌC PHỔ THÔNG CHUYÊN HÀ NỘI - AMSTERDAM </h5>
                    <h5 style="margin:.2em;font-size:4mm;font-weight:bold;">NĂM HỌC 2023-2024 </h5>
                </center>
            </div>
        </div>

        <h3 style="margin:.6em;text-decoration: underline 2px; text-underline-offset: 2px;;">I/ THÔNG TIN CÁ NHÂN</h3>
            <div class="row">
                <div class="field" style="width:45%">
                    <label class="form-label">Phòng GDĐT:</label> 
                    <div class="form">{{form.phong_gddt }}</div>
                </div>
                <div class="field" style="width:45%">
                    <label class="form-label">Trường tiểu học:</label> 
                    <div class="form">{{form.truong_tieu_hoc}}</div>
                </div>
            </div>
            
            <div class="row">
                <div class="field" style="width:50%">
                    <label class="form-label">Họ và tên học sinh:</label> 
                    <div class="form">{{form.ho_va_ten }}</div>
                </div>
                <div class="field" style="width:21%">
                    <label class="form-label">Lớp:</label> 
                    <div class="form">{{form.lop}}</div>
                </div>
                <div class="field" style="width:15%">
                    <label class="form-label">Giới tính:</label> 
                    <div class="form">{{form.gioi_tinh}}</div>
                </div>
            </div>

            <div class="row">
                <div class="field" style="width:26%">
                    <label class="form-label">Tháng/ngày/năm sinh:</label> 
                    <div class="form">{{form.ngay_sinh }}</div>
                    <span style="font-size:3mm"><i>(Ghi đúng theo giấy khai sinh)</i></span>
                </div>
                <div class="field" style="width:30%">
                    <label class="form-label">Nơi sinh:</label> 
                    <div class="form">{{form.noi_sinh}}</div>
                    <span style="font-size:3mm"><i>(Ghi tên Tỉnh/Thành phố)</i></span>
                </div>
                <div class="field" style="width:30%">
                    <label class="form-label">Dân tộc:</label> 
                    <div class="form">{{form.dan_toc}}</div>
                    <span style="font-size:3mm"><i>&nbsp; </i></span>
                </div>
            </div>
            <div class="row">
                <div class="field">
                    <span style="display: flex;flex-direction: column;"  class="form-label">Nơi thường trú:</span>
                </div>
                <div class="field" style="width:32%">
                    <label>Số nhà (ngõ/ngách):</label> 
                    <div class="form">{{form.noi_thuong_tru_so_nha }}</div>
                </div>
                <div class="field" style="width:33%">
                    <label>Tổ (thôn/khu phố):</label> 
                    <div class="form">{{form.noi_thuong_tru_to}}</div>
                </div>
            </div>


            <div class="row">
                <div class="field" style="width:29%">
                    <label>Phường (xã/thị trấn):</label> 
                    <div class="form">{{form.noi_thuong_tru_phuong}}</div>
                </div>
                <div class="field" style="width:29%">
                    <label>Quận (huyện):</label> 
                    <div class="form">{{form.noi_thuong_tru_quan_huyen}}</div>
                </div>
                <div class="field" style="width:29%">
                    <label>Tỉnh (thành phố):</label> 
                    <div class="form">{{form.noi_thuong_tru_tinh}}</div>
                </div>
            </div>

            <div class="row">
                <div class="field" style="width:29%">
                    <label class="form-label">Số điện thoại:</label> 
                    <div class="form">{{form.sdt}}</div>
                    <span style="font-size:3mm"><i>&nbsp; </i></span>
                </div>
                <div class="field" style="width:29%">
                    <label  class="form-label">Mã định danh: </label>
                    <div class="form">{{form.ma_dinh_danh}}</div>
                    <span style="font-size:3mm"><i>(gồm 12 số do do cơ quan Công an cấp)</i></span>
                </div>
                <div class="field" style="width:29%">
                    <label  class="form-label">Mã học sinh:</label>
                    <input type="text" name="ma_hoc_sinh" value="{{application.user.username}}" readonly="readonly">
                    <span style="font-size:3mm"><i>(gồm 10 số trên CSDL ngành GDĐT)</i></span>
                </div>
            </div>

        <h3 style="margin:0.4em;text-decoration: underline 2px;    text-underline-offset: 2px;">II/ THÔNG TIN SƠ TUYỂN</h3>
        <h4 style="margin:0.2em">1. Khen thưởng cuối năm</h4>
            <p style="margin:0.3em;font-size:3.5mm">(Nếu học sinh đạt danh hiệu “Học sinh hoàn thành tốt các nội dung học tập và rèn luyện” chọn mục là “HTT”; “hoàn thành xuất sắc
                các nội dung học tập và rèn luyện” thì chọn mục là “HTXS” vào cột tương ứng các lớp tương ứng)</p>
            <center>
            <div id="khen-thuong">
                <table id="khen" style="width:70%">
                    <tbody>
                        <tr>
                            <th>Lớp 1</th>
                            <th>Lớp 2</th>
                            <th>Lớp 3</th>
                            <th>Lớp 4</th>
                            <th>Lớp 5</th>
                        </tr>
                        <tr>
                            <td>{{form.khen_thuong_1}}</td>
                            <td>{{form.khen_thuong_2}}</td>
                            <td>{{form.khen_thuong_3}}</td>
                            <td>{{form.khen_thuong_4}}</td>
                            <td>{{form.khen_thuong_5}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </center>

        <h4 style="margin:0.2em;margin-top:1em">2. Kết quả kiểm tra định kì cuối năm</h4>

            <center>
                <div id="ket-qua">
                    <table id="kq" style="width:80%;">
                        <tbody>
                            <tr>
                                <th style="width:45mm">Môn</th>
                                <th>Lớp 1</th>
                                <th>Lớp 2</th>
                                <th>Lớp 3</th>
                                <th>Lớp 4</th>
                                <th>Lớp 5</th>
                                <th style="width:15mm">Tổng điểm</th>
                            </tr>
                            <tr>
                                <td class="form-label" style="text-align: center;font-size:4mm">Toán</td>
                                <td>{{form.ket_qua_1_toan}}</td>
                                <td>{{form.ket_qua_2_toan}}</td>
                                <td>{{form.ket_qua_3_toan}}</td>
                                <td>{{form.ket_qua_4_toan}}</td>
                                <td>{{form.ket_qua_5_toan}}</td>
                                <td  style="border:none !important"></td>
                            </tr>
                            <tr>
                                <td class="form-label" style="text-align: center;font-size:4mm">Tiếng Việt</td>
                                <td>{{form.ket_qua_1_tieng_viet}}</td>
                                <td>{{form.ket_qua_2_tieng_viet}}</td>
                                <td>{{form.ket_qua_3_tieng_viet}}</td>
                                <td>{{form.ket_qua_4_tieng_viet}}</td>
                                <td>{{form.ket_qua_5_tieng_viet}}</td>
                                <td  style="border:none !important"></td>
                            </tr>
                            <tr>
                                <td class="form-label" style="text-align: center;font-size:4mm;">Khoa học</td>
                                <td class="null"></td>
                                <td class="null"></td>
                                <td class="null"></td>
                                <td>{{form.ket_qua_4_khoa_hoc}}</td>
                                <td>{{form.ket_qua_5_khoa_hoc}}</td>
                                <td style="border:none !important;text-align: center;font-family: 'Roboto';">
                                {% if done %}
                                    {{application.tong_diem}}
                                {% endif%}
                                </td>
                            </tr>
                            <tr>
                                <td class="form-label" style="text-align: center;font-size:4mm;">Lịch sử và địa lí</td>
                                <td class="null"></td>
                                <td class="null"></td>
                                <td class="null"></td>
                                <td>{{form.ket_qua_4_su_dia}}</td>
                                <td>{{form.ket_qua_5_su_dia}}</td>
                                <td  style="border:none !important"></td>
                            </tr>
                            <tr>
                                <td class="form-label" style="text-align: center;font-size:4mm;">Tiếng Anh</td>
                                <td class="null"></td>
                                <td class="null"></td>
                                <td>{{form.ket_qua_3_tieng_anh}}</td>
                                <td>{{form.ket_qua_4_tieng_anh}}</td>
                                <td>{{form.ket_qua_5_tieng_anh}}</td>
                                <td style="border:none !important"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </center>
            <center>
            <p><b><i>Cha/mẹ/người giám hộ của học sinh cam đoan các thông tin cung cấp trong đơn đăng ký dự tuyển trên là
                đúng sự thật; nếu không đúng sẽ bị xử lý theo quy định hiện hành và hủy kết quả trúng tuyển.</i></b></p>
            </center>
                
            
                <div style="width:50%;float:right">
                    <center>
                        {% if not done %}
                        <div><i>Hà Nội, ngày.....tháng.....năm 2023</i></div>
                        {% else %}
                        <div><i>Hà Nội, ngày {{ application.ngay_nop|date:"d"}} tháng {{application.ngay_nop|date:"m"}} năm 2023</i></div>
                        {% endif %}
                        <div><b>CHA/MẸ/NGƯỜI GIÁM HỘ CỦA HỌC SINH</b></div>
                        <div><i>(Ký, ghi họ tên)</i> </div>
                        <div style="border-top:1px solid black; width:30mm;margin-top:1.5cm"></div>
                    </center>

              
            </div>
           
    </form>
</div>

    <center>
        {% if not done %}
        <button style="margin: 1em" type="submit" form="wrapper" onclick="!this.form && document.getElementById('wrapper').submit()">Nộp</button>
        {% endif %}
    </center>

{% if done %}
<script>
    $(':input').attr('readonly','readonly');
    $('select').prop("disabled", true);

    function print_form(){
        $('#wrapper').printThis({importStyle: false,importCSS:false, loadCSS:["{% static 'application.css' %}"]});
    }
</script>
{% endif %}



<script>
    const actualBtn = document.getElementById('id_anh_3x4');

    const fileChosen = document.getElementById('file-chosen');

    actualBtn.addEventListener('change', function(){
        fileChosen.textContent = "Đã chọn ảnh "
        var output = document.getElementById('output');
        output.src = URL.createObjectURL(this.files[0]);
        output.hidden = false;
        output.onload = function() {
        URL.revokeObjectURL(output.src) // free memory
        }
    })
</script>
